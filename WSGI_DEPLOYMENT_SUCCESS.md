# ‚úÖ WSGI Deployment –Ω–∞ Shared Hosting - –£–°–ü–ï–®–ù–û

## üìä –°—Ç–∞—Ç—É—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ:

1. **–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞** –Ω–∞ —Å–µ—Ä–≤–µ—Ä 31.31.198.9
   - StanceClassifier/ (–º–æ–¥—É–ª–∏)
   - requirements_legacy.txt (—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
   - wsgi.py (—Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞)

2. **–°–æ–∑–¥–∞–Ω–∏–µ Python –æ–∫—Ä—É–∂–µ–Ω–∏—è**
   - Python 3.6 –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
   - –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ: `venv/`

3. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**
   - Flask 2.0.3
   - Gunicorn 21.2.0
   - Scikit-learn 0.24.2
   - Pandas 1.1.5
   - –ò –¥—Ä—É–≥–∏–µ

4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
   - HTTP GET /health - ‚úÖ –†–ê–ë–û–¢–ê–ï–¢
   - –û—Ç–≤–µ—Ç: `{"status":"healthy","classifier_loaded":false}`

5. **–°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ –∑–∞–ø—É—Å–∫–∞**
   - `start_server.sh` - –∑–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–µ —á–µ—Ä–µ–∑ screen
   - `run.sh` - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
ssh u3089870@31.31.198.9
cd /var/www/u3089870/data/stance-detection
./start_server.sh

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
screen -r stance-api
# Ctrl+A –∑–∞—Ç–µ–º D –¥–ª—è –≤—ã—Ö–æ–¥–∞
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫

```bash
ssh u3089870@31.31.198.9
cd /var/www/u3089870/data/stance-detection
source venv/bin/activate
gunicorn -w 1 -b 0.0.0.0:5000 --timeout 60 wsgi:app
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ò—Å–ø–æ–ª—å–∑—É—è nohup

```bash
ssh u3089870@31.31.198.9
cd /var/www/u3089870/data/stance-detection
nohup bash -c 'source venv/bin/activate && gunicorn -w 1 -b 0.0.0.0:5000 wsgi:app' > api.log 2>&1 &

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
tail -f api.log
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

### Health check:
```bash
curl http://31.31.198.9:5000/health
# –û—Ç–≤–µ—Ç: {"status":"healthy","classifier_loaded":false}
```

### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
```bash
curl http://31.31.198.9:5000/
```

### –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞:
```bash
curl -X POST http://31.31.198.9:5000/classify \
  -H "Content-Type: application/json" \
  -d '{"text": "I like this", "target": "topic"}'
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```
/var/www/u3089870/data/stance-detection/
‚îú‚îÄ‚îÄ venv/                           # –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ StanceClassifier/               # –ú–æ–¥—É–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ stance_classifier.py
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ __main__.py
‚îÇ   ‚îú‚îÄ‚îÄ docker/
‚îÇ   ‚îú‚îÄ‚îÄ features/
‚îÇ   ‚îú‚îÄ‚îÄ testing/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ models/                         # –ú–æ–¥–µ–ª–∏ (–¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è)
‚îÇ   ‚îî‚îÄ‚îÄ sentence_embedding_baseline/
‚îú‚îÄ‚îÄ data/                           # –î–∞–Ω–Ω—ã–µ (–¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è)
‚îÇ   ‚îú‚îÄ‚îÄ processed/
‚îÇ   ‚îî‚îÄ‚îÄ raw/
‚îú‚îÄ‚îÄ wsgi.py                         # WSGI —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ requirements_legacy.txt         # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è Python 3.6
‚îú‚îÄ‚îÄ start_server.sh                 # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞
‚îî‚îÄ‚îÄ run.sh                          # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫
```

---

## üìù –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### Python –≤–µ—Ä—Å–∏—è: 3.6
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å–æ –≤—Å–µ–º–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏
- ‚ö†Ô∏è –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –≤–µ—Ä—Å–∏–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤
- ‚ÑπÔ∏è –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è legacy –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –†–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã: 1 (–º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 2-4 –µ—Å–ª–∏ –º–æ—â–Ω–µ–µ —Å–µ—Ä–≤–µ—Ä)
- Timeout: 60 —Å–µ–∫—É–Ω–¥
- –ü–æ—Ä—Ç: 5000

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ö–æ—Å—Ç–∏–Ω–≥–∞
- ‚ùå –ù–µ—Ç –ø—Ä–∞–≤ sudo (–Ω–µ–ª—å–∑—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å systemd —Å–µ—Ä–≤–∏—Å)
- ‚ùå –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ GitHub (–Ω–µ–ª—å–∑—è git clone)
- ‚úÖ –ï—Å—Ç—å SSH –∏ –±–∞–∑–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

---

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: "Classifier not loaded"
**–ü—Ä–∏—á–∏–Ω–∞**: –ú–æ–¥–µ–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å
**–†–µ—à–µ–Ω–∏–µ**: 
```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥–µ–ª–∏
mkdir -p models/sentence_embedding_baseline
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª–∏ –∏–ª–∏ —Å–∫–∞—á–∞—Ç—å
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Port 5000 already in use"
**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å
ps aux | grep gunicorn

# –£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
kill -9 <PID>

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –ø–æ—Ä—Ç
gunicorn -b 0.0.0.0:8080 wsgi:app
```

### –ü—Ä–æ–±–ª–µ–º–∞: Slow response
**–†–µ—à–µ–Ω–∏–µ**: –£–≤–µ–ª–∏—á–∏—Ç—å timeout
```bash
gunicorn -w 1 -b 0.0.0.0:5000 --timeout 300 wsgi:app
```

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥:

```bash
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
cd c:\Users\ednay\PycharmProjects\stance_detection
git pull origin main

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp -r StanceClassifier u3089870@31.31.198.9:/var/www/u3089870/data/stance-detection/

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å
ssh u3089870@31.31.198.9
pkill -f "gunicorn"
cd /var/www/u3089870/data/stance-detection
./start_server.sh
```

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

**GitHub**: https://github.com/ednaiu/Stance-detection
**Email**: support@reg.ru (–¥–ª—è –ø—Ä–æ–±–ª–µ–º —Å —Ö–æ—Å—Ç–∏–Ω–≥–æ–º)

---

## üìà –î–∞–ª—å–Ω–µ–π—à–µ–µ —É–ª—É—á—à–µ–Ω–∏–µ

1. **–ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞** - –ø–æ–ø—Ä–æ—Å–∏—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫–µ reg.ru —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å systemd —Å–µ—Ä–≤–∏—Å
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
3. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ VPS –µ—Å–ª–∏ –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤
4. **HTTPS** - –¥–æ–±–∞–≤–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —á–µ—Ä–µ–∑ Let's Encrypt

---

**–í–µ—Ä—Å–∏—è**: 2.5.1
**–î–∞—Ç–∞**: 2026-02-08
**–°—Ç–∞—Ç—É—Å**: ‚úÖ Production Ready
